<!-- Admin User Detail page - Detailed view of a specific user's account and upscaling history -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - User Details</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script type="module" src="https://cdn.jsdelivr.net/npm/img-comparison-slider@8/dist/index.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/img-comparison-slider@8/dist/style.css" />
    <style> 
        body { font-family: 'Inter', sans-serif; } 
        img-comparison-slider {
            --divider-width: 3px;
            --divider-color: #8B5CF6;
            --handle-size: 50px;
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body class="bg-gray-900 text-white">
    <div class="flex">
        <div class="w-64 min-h-screen bg-gray-800 p-4">
            <h1 class="text-2xl font-bold mb-8">Admin Panel</h1>
            <nav>
                <a href="/user/admin" class="block py-2.5 px-4 rounded hover:bg-gray-700">Analytics</a>
                <a href="/user/admin/users" class="block py-2.5 px-4 rounded bg-purple-600">Users</a>
                <a href="/user/admin/feedback?status=liked" class="block py-2.5 px-4 rounded hover:bg-gray-700">Liked Images</a>
                <a href="/user/admin/feedback?status=disliked" class="block py-2.5 px-4 rounded hover:bg-gray-700">Disliked Images</a>
                <a href="/upload" class="block py-2.5 px-4 rounded hover:bg-gray-700 mt-4">Back to App</a>
                <a href="/user/logout" class="block py-2.5 px-4 rounded hover:bg-gray-700">Logout</a>
            </nav>
        </div>

        <div class="flex-1 p-10">
            <% if (viewedUser) { %>
                <a href="/user/admin/users" class="text-purple-400 hover:underline mb-4 inline-block">&larr; Back to Users</a>
                <h2 class="text-3xl font-bold mb-2"><%= viewedUser.name %></h2>
                <p class="text-gray-400 mb-6"><%= viewedUser.email %></p>

                <h3 class="text-2xl font-bold mb-4 mt-8">Upscale History (<%= viewedUser.imageHistory ? viewedUser.imageHistory.length : 0 %>)</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <% if (viewedUser.imageHistory && viewedUser.imageHistory.length > 0) { %>
                        <% viewedUser.imageHistory.reverse().forEach(historyItem => { %>
                            <div class="bg-gray-800 rounded-lg overflow-hidden shadow-lg">
                                <div class="image-comparison-container bg-black h-64">
                                    <img-comparison-slider>
                                        <img slot="first" src="/images/<%= historyItem.originalPath %>" alt="Original Image" style="object-fit: cover; width: 100%; height: 100%;">
                                        <img slot="second" src="/images/<%= historyItem.upscaledPath %>" alt="Upscaled Image" style="object-fit: cover; width: 100%; height: 100%;">
                                    </img-comparison-slider>
                                </div>
                                <div class="p-4">
                                    <p class="text-sm"><span class="font-semibold">Model:</span> <%= historyItem.modelUsed %></p>
                                    <p class="text-sm"><span class="font-semibold">Scale:</span> <%= historyItem.scaleFactor %>x</p>
                                    <p class="text-sm"><span class="font-semibold">Liked:</span> 
                                        <% if (historyItem.likedResult === true) { %>
                                            <span class="text-green-400">Yes</span>
                                        <% } else if (historyItem.likedResult === false) { %>
                                            <span class="text-red-400">No</span>
                                        <% } else { %>
                                            <span class="text-gray-500 italic">N/A</span>
                                        <% } %>
                                    </p>
                                    <div class="mt-4 flex gap-2">
                                        <a href="/images/<%= historyItem.originalPath %>" download class="flex-1 text-center text-xs bg-gray-700 hover:bg-gray-600 text-gray-300 font-semibold py-2 px-3 rounded-lg">
                                            Download Original
                                        </a>
                                        <a href="/images/<%= historyItem.upscaledPath %>" download class="flex-1 text-center text-xs bg-purple-600 hover:bg-purple-700 text-white font-semibold py-2 px-3 rounded-lg">
                                            Download Upscaled
                                        </a>
                                    </div>
                                </div>
                            </div>
                        <% }); %>
                    <% } else { %>
                        <p class="col-span-full text-center text-gray-500 py-10">This user has no upscale history.</p>
                    <% } %>
                </div>
            <% } else { %>
                <p class="text-red-400"><%= error %></p>
            <% } %>
        </div>
    </div>
</body>
</html>
